 {% extends 'nav.html' %} {% block body1 %}
<div id="myNav" class="overlay">

  <!-- Overlay content -->
  <div class="overlay-content">
            
            <div class="col-md-6">
                    <div class='col-md-4 col-md-push-4 cent'>
                            <button type='button' id='o_start' class='o_startbtn'><i class="fa fa-microphone" aria-hidden="true"></i> </button>
                     
                    </div>
                    <div class="col-md-12">
                        <p class='o_start_desc' id='o_start_desc'>Each day this is the first button you will use, to begin your daily recording. From here you will be brought to a page with a small passage of text you will be required to read.</p>
                    </div>
                </div>
            <div class="col-md-6">
                <div class='o_notif' id='o_notif'>
                    <p class="n_head">Notifications</p>
                </div> 
                <p class='o_start_desc' id='o_notif_des'>This is your notification box. Any messages you receive from your doctor or any information regarding your results will be displayed in this box.</p>
            </div>
            <div id='_navhelp'>
                <p class='o_nav_des'>You can contact your doctor, see your results and change your setting via this toolbar.</p>
            </div>
            <div id='o_read_help'>
                    <img src='../static/images/Capture.PNG' class='read_help'>
                <p class='o_read_des'>On this screen you will be asked to perform a reading of a small passage of text, whilst being recorded, so please ensure you are in frame in the video feed in the corner and are wearing your microphone.</p>
            </div>
            <div id='again'>
                    <p class='o_again_des'>To view this help screen again just click the Help button in the bottom left or top right corner.</p>
            </div>
<!--      button to start help    -->
                <button type='button' class='prevbtn' id='help' onclick="start_help()">Start</button>
                <button type='button' class='nextbtn' id='next' onclick="Next()">Next</button>
<!--                <button type='button' class='prevbtn' id='prev' onclick="Previous()">Previous</button>-->
      
                <!-- Button to close the overlay navigation -->
                <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
      
        </div>
    </div>


<!-- Use any element to open/show the overlay navigation menu -->
    
    
    <div class="container-fluid">
        <div class="row">
            <div>
                
                <h2 class='menu_head'><span class="open" onclick="openSide()"><i class="fa fa-bars" aria-hidden="true"></i>
</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hi {{session['user']}} <a><span onclick="openNav()" class='help_head' style='cursor: pointer;'>Help</span></a></h2> 
                <img class='header_bottom' src='../static/images/headerBottom.png'> 
            </div>
            
                <div class="col-md-6 left">
                    <div class="card">
                        <div class="cent mic_box">
                            <a href="/select">
                                <button type="button" class="startbtn"><i class="fa fa-microphone" aria-hidden="true"></i> </button>
                            </a>
                        
                        <div class="cent">
                            <p class="start_desc">Click here to start recording</p>
                        </div>
                        </div>
                    </div>
                
                    <div class='card'>
                     <div class='tip_box'>   
                            <ul class='nav nav-tabs' role="tablist" style='text-align:center;'>
                                <li role='presentation' class='active'><a role='tab' data-toggle='tab' href="#quick_panel">Quick Links</a></li>
                                <li role='presentation'><a role='tab' data-toggle='tab' href="#care_panel">Care Team</a></li>
                            </ul>

                            <div class='tab-content' style='margin-top:0px; padding-bottom: 20px;'>
                                <div role='tabpanel' class='tab-pane active' id='quick_panel'>
                                    <div class="row">
                                        <div class="col-xs-4 cent">
                                             <i class="fa fa-plus-square-o quick_icon" aria-hidden="true" style="font-size:40px;" type="button" data-toggle="modal" data-target="#consult"></i>
                                              <p>eConsultation</p>
                                            
                                            <i class="fa fa-clock-o quick_icon" aria-hidden="true" style="font-size:40px; margin-top:35px"  type="button" data-toggle="modal" data-target="#remind"></i>
                                            <p>Set Reminder</p>

                                        </div>
                                        <div class="col-xs-4 cent">
                                            <i class="fa fa-calendar quick_icon" aria-hidden="true" style="font-size:40px;"  type="button" data-toggle="modal" data-target="#appoint"></i>
                                              <p>Request Appointment</p>
                                            <i class="fa fa-file-excel-o quick_icon" aria-hidden="true" style="font-size:40px; margin-top:35px"  type="button" data-toggle="modal" data-target="#myModal"></i>
                                                <p>Forms</p>
                                        </div>
                                        <div class="col-xs-4 cent">
                                            <i class="fa fa-xing quick_icon" aria-hidden="true" style="font-size:40px;"  type="button" data-toggle="modal" data-target="#rx"></i>
                                                <p>Request Rx Refill</p>
                                            <i class="fa fa-address-card quick_icon" aria-hidden="true" style="font-size:40px; margin-top:35px"  type="button" data-toggle="modal" data-target="#contact"></i>
                                                <p>Update Information</p>

                                        </div>
                                    </div>
                                    </div>

                                <div role='tabpanel' class='tab-pane' id='care_panel'>
                                    <div class="row">
                                        <div class="col-xs-4 cent">
<!--                                            <a href="/config/">-->
<!--                                                <i class="fa fa-user-md" aria-hidden="true" style="font-size: 80px;"></i>-->
                                            <a href="/config/"><img src="../static/images/agnia.jpg" style='width:100%;'></a>
                                              <p>Dr. Shirley</p>
                                              <p>096 12345</p>
                                        </div>
                                        <div class="col-xs-4 cent">
<!--                                            <i class="fa fa-user-md" aria-hidden="true" style="font-size: 80px;"></i>-->
                                             <img src='../static/images/dave.jpg' style='width:78%;'> 
                                            <p>Nursey McNurseface</p>
                                              <p>111 11112</p>
                                        </div>
                                        <div class="col-xs-4 cent">
<!--                                            <i class="fa fa-medkit" aria-hidden="true" style="font-size: 80px;"></i>-->
                                            <img src='../static/images/bear.png' style='width:88%;'>
                                                <p>Mr. Carer</p><p>(in house help)</p>
<!--                                            <i class="fa fa-plus" aria-hidden="true"></i>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div> <!-- tip box close -->
                    
                </div>  <!-- left column div close -->

            
                    <div class='col-md-6 right'>
                            <div class='card notif'>
                                <p class="n_head">Notifications</p>
                                <p id='notificationBox2'> </p>
                            </div> 
                        
                        
                        <div class='card cal_box'>
                            <div id='container' class="calendar-container"></div>
                        </div>
                        </div>
                    </div>
            </div> <!-- container div -->

                <div id="consult" class="modal fade" role="dialog">         <!-- econsult modal -->
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close recordbtn" data-dismiss="modal">&times;</button>
                                        <h4 class="modal-title">New eConsultaion</h4>
                                    </div>
                                    <div class="modal-body">
                                        <!--- Js will target this and insert the content here.-->
                                        <img src='../static/images/doc.PNG' style='width:100%;'>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    <div id="appoint" class="modal fade" role="dialog">         <!-- appoint modal -->
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close recordbtn" data-dismiss="modal">&times;</button>
                                        <h4 class="modal-title">Request Appointment</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form action="" method="">
                                            <div class="form-group" style="display:inline;">
                                                <label for="username">New date:</label>
                                                <input class="form-control-date" type="text">
                                            </div>
                                            <div class="form-group">
                                                <label for="pwd">Message:</label>
                                                <input class="form-control-message" type="password">
                                            </div>
                                           <button class="logbtn" >Save</button>

                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="rx" class="modal fade" role="dialog">         <!-- rx modal -->
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close recordbtn" data-dismiss="modal">&times;</button>
                                        <h4 class="modal-title">Request Rx Refill</h4>
                                    </div>
                                    <div class="modal-body">
                                        <table class="table table-hover">
                                            <thead>
                                              <tr>
                                                <th>Medicine</th>
                                                <th>Dose</th>
                                                <th>Date Prescribed</th>
                                              </tr>
                                            </thead>
                                            <tbody>
                                              <tr>
                                                <td>Levodopa</td>
                                                <td>100mg</td>
                                                <td>9-7-17</td>
                                              </tr>
                                              <tr>
                                                <td>Carbidopa</td>
                                                <td>25mg</td>
                                                <td>9-7-17</td>
                                              </tr>
                                              <tr>
                                                <td>Entacapone</td>
                                                <td>200mg</td>
                                                <td>9-7-17</td>
                                              </tr>
                                            </tbody>
                                          </table>
                                        <button type="button" class="logbtn">Refill</button>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="remind" class="modal fade" role="dialog">         <!-- Set Reminder modal -->
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close recordbtn" data-dismiss="modal">&times;</button>
                                        <h4 class="modal-title">Set Reminder</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form action="" method="">
                                            <div class="form-group" style="">
                                                <label for="username">Title:</label>
                                                <input name="username" id="username" class="form-control" type="text">
                                            </div>
                                            <div class=" row form-group">
                                                <div class='col-xs-6'>
                                                    <label for="pwd">Date:</label>
                                                    <input name="password" id="pwd" class="form-control" type="password">
                                                </div>
                                                <div class='col-xs-6'>
                                                    <label for="pwd">Time:</label>
                                                    <input name="password" id="pwd" class="form-control" type="password">
                                                </div>
                                            </div>
                                            <button type="submit" class="logbtn" value="Login">Save</button>

                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="contact" class="modal fade" role="dialog">         <!-- Set contatc modal -->
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close recordbtn" data-dismiss="modal">&times;</button>
                                        <h4 class="modal-title">Update Information</h4>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <label for="username">New contact no: </label>
                                            <input type="text" name="" class="form-control" >
                                        </div>
                                        <div class="form-group">
                                            <label for="pwd">New Landline: </label>
                                            <input type="text" name="" class="form-control" > 
                                        </div>
                                        <div class="form-group">
                                            <label for="age">New Address: </label>
                                            <input type="text" name="" class="form-control"> 
                                        </div>
                                        <div class='form-group'>
                                            <label for="age">New equipment: </label>
                                            <input type="text" name="" class="form-control">
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
    
    
    <script>
        function openSide() {
        document.getElementById("mySidenav").style.width = "20%";
        document.getElementById("mySidenav").style.display = 'initial';
    };
    /* Set the width of the side navigation to 0 */
    function closeSide() {
        document.getElementById("mySidenav").style.width = "0";
        document.getElementById("mySidenav").style.display = 'none';
    };
                            //   notification window
        var message = ''
        var lastMessage = ''
        var nPar = document.getElementById("notificationBox2");
        console.log(nPar)
        $(function () {             //adds active class to navbar element
            $('a').each(function () {
                if ($(this).prop('href') == window.location.href) {
                    $(this).addClass('active');
                    $(this).parents('li').addClass('active');
                }
            });
        });
        var notList = ""
        $(document).ready(function () {
            var days = '{{days}}';
            var decodeHtmlEntity = function (x) {
                    return x.replace(/&#(\d+);/g, function (match, dec) {
                        return String.fromCharCode(dec);
                });
            };
            var cleanedData = decodeHtmlEntity(days);
            console.log(cleanedData)

            $("#container").simpleCalendar({
                fixedStartDay: false,
                takendays: cleanedData
            });
            message = '{{message}}'
            notifications(message);
            setInterval(getNotifications, 15000);

            if ($(latest) != null)
                $(latest).fadeIn(500).fadeOut(500).fadeIn(500).fadeOut(500).fadeIn(500).fadeOut(500).fadeIn(500);
        });

        function notifications(message){
            var decodeHtmlEntity = function (x) {
                    return x.replace(/&#(\d+);/g, function (match, dec) {
                        return String.fromCharCode(dec);
                });
            };
            var cleanedData = decodeHtmlEntity(message);
            console.log(cleanedData)
            var c = JSON.parse(cleanedData);
            nPar.innerHTML = ""
            if (c.message == "No notifications to display"){
                nPar.innerHTML += c;
            }
            else{
                var keyList = []
                for (key in c.message){
                    keyList.push(key);
                }
                for (var i=keyList.length-1;i>=0;i--){
                    var nMessage = c.message[keyList[i]];
                    var nType = c.type[keyList[i]];
                    var nFrom = c.from[keyList[i]];
                    var preTag="<a";
                    var postTag="</span></a><br />";

                    if (i == keyList.length-1){
                        preTag += " id='latest'"
                    }
                    if (nType === 'help'){
                        preTag += " href='#'><span onclick='openNav()'>";
                        openNav();
                        
                    }
                    else if(nType === 'results'){
                        preTag += " href='/res'>";
                    }
                    else{
                        preTag += '>';
                    }

                    nPar.innerHTML += nFrom + ": " + preTag + nMessage + postTag; 
                }
            }

        }

        function getNotifications() {
            $.get("{{ url_for('updateNotifications') }}", function(data) {
                notifications(data);
            });
        }

        
        
        /*   js for overlay   */
        
        var tracker = 0;
        var o_sb = document.getElementById("o_start");
        o_sb.style.display = "none"
        var o_sd = document.getElementById("o_start_desc");
        o_sd.style.display = "none"
        var o_nb = document.getElementById("o_notif");
        o_nb.style.display = "none"
        var o_nd = document.getElementById("o_notif_des");
        o_nd.style.display = "none"
        var help = document.getElementById("help");
        help.style.display = 'none';
        var next = document.getElementById("next");
        next.style.display = "none";
//        var prev = document.getElementById("prev");
//        prev.style.display = "none"
        var nav = document.getElementById("_navhelp");
        nav.style.display = "none"
        var read = document.getElementById("o_read_help");
        read.style.display = "none"
        var again = document.getElementById("again");
        again.style.display = "none"

        
        
        
        function changeDiv(tracker){
            if (tracker == 0){
                 o_sb.style.display = 'initial'
                o_sd.style.display = 'block'            //after press start btn opens mic desc
                help.style.display = 'none'
                next.style.display = 'initial'
            }
            if (tracker == 1){
                o_sb.style.display = 'none'
                o_sd.style.display = 'none'
                o_nb.style.display = 'block'
                o_nd.style.display = 'block'
//                prev.style.display = "initial"
            }
            else if (tracker == 2){
                o_nb.style.display = 'none'
                o_nd.style.display = 'none'
                $(".sidenav").css("border","5px solid");
                $(".sidenav").css("border-color","#fff");
//                $(".sidenav").css("transition",".3s");
                nav.style.display = "initial"
            }
            else if (tracker == 3){
                nav.style.display = 'none'
                $(".sidenav").css("border","0px solid");
                $(".sidenav").css("border-color","#fff");
//                $(".sidenav").css("transition","1s");
                read.style.display = "initial"
            }
            else if (tracker == 4){
                read.style.display = 'none'
                again.style.display = 'initial'
                next.innerHTML = "Done"
            }
        };
        
        var max = 5;
        
        function start_help(){
            changeDiv(tracker)
        };
        
        function Next(){
            if (tracker == 0)
                tracker = 1;
            changeDiv(tracker)
            tracker = tracker + 1;
//            prev.style.display = "initial"
            if(tracker > max)
                closeNav();
            
        };
//        function Previous(){
//            tracker = tracker - 1;
//            changeDiv(tracker)
//            if(tracker < 0)
//                tracker = 0; 
//                prev.style.display = "none";
//        };
        

                /* Open when someone clicks on the span element */
        function openNav() {
            console.log('help');
            document.getElementById("myNav").style.height = "100%";
            setTimeout('help.style.display= "initial";', 1000);
        };
        /* Close when someone clicks on the "x" symbol inside the overlay */
        function closeNav() {
            document.getElementById("myNav").style.height = "0%";
            again.style.display = 'none'
            tracker = 0;
            next.innerHTML = "Next"
            next.style.display = 'none'
        } ;

</script>
<!---->
{% endblock %}
